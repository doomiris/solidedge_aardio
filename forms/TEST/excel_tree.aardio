import console; 
import com.excel;
var excel = com.excel( false );
var sht = excel.ActiveWorkbook.ActiveSheet;


_start_lvl = 2;
_Depth = 2;

var UG = sht.UsedRange.value2;

/*
var rows = sht.UsedRange.Rows;

sht.UsedRange.Rows.Hidden = false;

try{
	rows.UnGroup();
}

*/
//return;

import tarray;

UG.fields = table.shift(UG)

UG = tarray.mapfields(UG);

for(i=1;#UG)
	UG[i]["展开层"] = tonumber(string.trimleft(UG[i]["展开层"],"."));

for(i=1;#UG){
	UG[i]["hasChild"] = (UG[i+1]) ? (UG[i+1]["展开层"] > UG[i]["展开层"]) : false;
}


for(i=2; #UG){
	var parent = UG[1]["对象标识"];
	
}
console.dump(UG)

console.pause(true);


//{row:i, code:"BG", desp:"SV", children={[1]={}}}

